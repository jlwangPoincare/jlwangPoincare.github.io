<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="IEEE浮点数规范是个有趣的事儿">

    <link rel="stylesheet" type="text/css" media="screen" href="../stylesheets/w_style.css">
    <script>
function prepareEventHandler()
{
    var transformNode = document.getElementById("transform");
    //var titleA = titleNode.getElementsByTagName("a")[0];
    transformNode.onmouseover = function ()
    {
        if (this.innerHTML == "我心匪石，不可转也")
        {
            this.innerHTML = "嘿！你抓到我了！";
        }
    }
    transformNode.onmouseout = function ()
    {
        if (this.innerHTML == "嘿！你抓到我了！")
        {
            this.innerHTML = "我心匪石，不可转也";
        }
    }
}

window.onload = function ()
{
    prepareEventHandler();
}
    </script>

    <title>IEEE浮点数规范是个有趣的事儿</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
      <header class="inner">
        <a id="forkme_banner" href="https://github.com/jlwangPoincare">View on GitHub</a>

        <h1 id="site_name"><a href="index.html" title="博客首页" target="_self">jlwangPoincare的个人博客</a></h1>
        <h2 id="site_subtitle"><span id="transform">我心匪石，不可转也</span></h2>
      </header>
    </div>
    <main class="outer">
      <article class="inner">
        <h1>IEEE浮点数规范是个有趣的事儿</h1>
        <h2 class="subtitle" style="display:none;">本文没有副标题</h2>
        <p>这可是我个人博客正经的第一篇文章呢！</p>
        <h3>引子</h3>
        <p>原本我是在思考一个leetcode题目，嗯，写出来也无妨，是leetcode第4题，如何找出两个已排好序的数组合起来之后的中位数。算法的基本思想其实并不难，但是有一些很头疼的细节需要考虑，大概还是因为我太弱了没有找到最好的解决办法吧。然后我就顺着自己的思路想了很多奇偶数、浮点数转换的问题。再然后，我就想到了这么个很重要的问题：我们知道单精度浮点数float的精度并不高，而且知道浮点数相等这件事不能随便用“==”运算符比较，那它能够准确地表达整数吗？</p>
        <p>说得具体点，比如说这么一小段代码：</p>
        <blockquote>
          <pre>// C++ code
float a = 3.0f;
cout &lt;&lt; a == 3.0f &lt;&lt; endl;

float b = 5.0f;
float c = b - a;
float d = (b + a) / 2.0f;
cout &lt;&lt; c == 2.0f &lt;&lt; endl;
cout &lt;&lt; d == 4.0f &lt;&lt; endl;
          </pre>
        </blockquote>
        <p>这段代码能够准确地执行全部输出1吗？虽然这种事情试一下是最好的回答方式，但我倒是真的挺想从原理上了解一下。而且我早就知道IEEE浮点数规范大体上是怎么回事，只是对一些细节不能烂熟于心。于是我就查了查网上的资料，有了这篇文章。</p>
        <h3>随手写的一些总结</h3>
        <p>我们无视烦人的小端序和大端序，将二进制浮点数的各个位按照正常人的方式，以（符号位）（指数部分）（尾数部分）从左到右排列好，在指数部分和尾数部分中，左边的数字为高位，代表2的高次方，右边的数字为低位，代表2的低次方。在IEEE标准规定的32位单精度浮点数中，指数部分有8位，尾数部分有23位。64位双精度浮点数中，指数部分有11位，尾数部分有52位。</p>
        <p>符号位最简单，0为正，1为负。如果符号位的数值是s，相当于(-1)<sup>s</sup>。</p>
        <p>一般情况下，指数部分是移码（亦称阶码）表示的2的某个整数次方，尾数部分是去掉起首的1之后的二进制浮点数尾数。</p>
        <p>IEEE浮点数标准中有几个特殊成员：正负零，正负无穷大，不是数（NaN）。</p>
        <p>上面这些都是对计算机内部原理有基本了解的人都懂得的知识。甚至你还可以说出移码的具体偏移量。甚至你可以说，知道这些内容已经足够回答文章开头的问题了。没错，这些内容我也知道，不过一来我在只知道这么点东西的情况下对一些细节不太放心，二来我查阅资料还想要知道比这更加详细的内容。那么自然，后面的内容才是本文的重头戏。</p>
        <h3>规约数和非规约数</h3>
        <p>后面的回头再写，先对付一下CSS。</p>
        <p>其实Javascript充分利用了IEEE浮点数规范来表示整数，很有意思，我到时候会写到，先放在这不要忘了。</p>
      </article>
    </main>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>



  </body>
</html>
